var saveAs=saveAs||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=e.URL||e.webkitURL||e,o=t.createElementNS("http://www.w3.org/1999/xhtml","a"),i=!e.externalHost&&"download"in o,a=e.webkitRequestFileSystem,d=e.requestFileSystem||a||e.mozRequestFileSystem,s=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},u="application/octet-stream",f=0,c=[],l=function(){for(var e=c.length;e--;){var t=c[e];"string"==typeof t?r.revokeObjectURL(t):t.remove()}c.length=0},v=function(e,t,n){t=[].concat(t);for(var r=t.length;r--;){var o=e["on"+t[r]];if("function"==typeof o)try{o.call(e,n||e)}catch(e){s(e)}}},w=function(r,s){var l,w,p,A=this,S=r.type,E=!1,y=function(){var e=n().createObjectURL(r);return c.push(e),e},m=function(){v(A,"writestart progress write writeend".split(" "))},O=function(){if(!E&&l||(l=y(r)),!w){if(navigator.userAgent.match(/7\.[\d\s\.]+Safari/)&&"undefined"!=typeof window.FileReader&&r.size<=157286400){var e=new window.FileReader;return e.readAsDataURL(r),e.onloadend=function(){var n=t.createElement("iframe");n.src=e.result,n.style.display="none",t.body.appendChild(n),m()},A.readyState=A.DONE,void(A.savedAs=A.SAVEDASUNKNOWN)}return window.open(l,"_blank"),A.readyState=A.DONE,A.savedAs=A.SAVEDASBLOB,void m()}w.location.href=l},h=function(e){return function(){if(A.readyState!==A.DONE)return e.apply(this,arguments)}},N={create:!0,exclusive:!1};if(A.readyState=A.INIT,s||(s="download"),i){l=y(r),t=e.document,o=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o.href=l,o.download=s;var R=t.createEvent("MouseEvents");return R.initMouseEvent("click",!0,!1,e,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(R),A.readyState=A.DONE,A.savedAs=A.SAVEDASBLOB,void m()}return e.chrome&&S&&S!==u&&(p=r.slice||r.webkitSlice,r=p.call(r,0,r.size,u),E=!0),a&&"download"!==s&&(s+=".download"),(S===u||a)&&(w=e),d?(f+=r.size,void d(e.TEMPORARY,f,h(function(e){e.root.getDirectory("saved",N,h(function(e){var t=function(){e.getFile(s,N,h(function(e){e.createWriter(h(function(t){t.onwriteend=function(t){w.location.href=e.toURL(),c.push(e),A.readyState=A.DONE,A.savedAs=A.SAVEDASBLOB,v(A,"writeend",t)},t.onerror=function(){var e=t.error;e.code!==e.ABORT_ERR&&O()},"writestart progress write abort".split(" ").forEach(function(e){t["on"+e]=A["on"+e]}),t.write(r),A.abort=function(){t.abort(),A.readyState=A.DONE,A.savedAs=A.FAILED},A.readyState=A.WRITING}),O)}),O)};e.getFile(s,{create:!1},h(function(e){e.remove(),t()}),h(function(e){e.code===e.NOT_FOUND_ERR?t():O()}))}),O)}),O)):void O()},p=w.prototype,A=function(e,t){return new w(e,t)};return p.abort=function(){var e=this;e.readyState=e.DONE,e.savedAs=e.FAILED,v(e,"abort")},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.FAILED=-1,p.SAVEDASBLOB=1,p.SAVEDASURI=2,p.SAVEDASUNKNOWN=3,p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null,e.addEventListener("unload",l,!1),A.unload=function(){l(),e.removeEventListener("unload",l,!1)},A}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&null!==module?module.exports=saveAs:"undefined"!=typeof define&&null!==define&&null!=define.amd?define([],function(){return saveAs}):"undefined"!=typeof Meteor&&(Meteor.saveAs=saveAs);