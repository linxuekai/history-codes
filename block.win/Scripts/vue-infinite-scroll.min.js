(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.infiniteScroll=t()})(this,function(){"use strict";var e="@@InfiniteScroll",t=function(e,t){var n,i,o,r,l,c=function(){e.apply(r,l),i=n};return function(){if(r=this,l=arguments,n=Date.now(),o&&(clearTimeout(o),o=null),i){var e=t-(n-i);e<0?c():o=setTimeout(function(){c()},e)}else c()}},n=function(e){return e===window?Math.max(window.pageYOffset||0,document.documentElement.scrollTop):e.scrollTop},i=document.defaultView.getComputedStyle,o=function(e){for(var t=e;t&&"HTML"!==t.tagName&&"BODY"!==t.tagName&&1===t.nodeType;){var n=i(t).overflowY;if("scroll"===n||"auto"===n)return t;t=t.parentNode}return window},r=function(e){return e===window?document.documentElement.clientHeight:e.clientHeight},l=function(e){return e===window?n(window):e.getBoundingClientRect().top+n(window)},c=function(e){for(var t=e.parentNode;t;){if("HTML"===t.tagName)return!0;if(11===t.nodeType)return!1;t=t.parentNode}return!1},u=function(){if(!this.binded){this.binded=!0;var e=this,n=e.el;e.scrollEventTarget=o(n),e.scrollListener=t(s.bind(e),200),e.scrollEventTarget.addEventListener("scroll",e.scrollListener);var i=n.getAttribute("infinite-scroll-disabled"),r=!1;i&&(this.vm.$watch(i,function(t){e.disabled=t,!t&&e.immediateCheck&&s.call(e)}),r=Boolean(e.vm[i])),e.disabled=r;var l=n.getAttribute("infinite-scroll-distance"),c=0;l&&(c=Number(e.vm[l]||l),isNaN(c)&&(c=0)),e.distance=c;var u=n.getAttribute("infinite-scroll-immediate-check"),a=!0;u&&(a=Boolean(e.vm[u])),e.immediateCheck=a,a&&s.call(e);var d=n.getAttribute("infinite-scroll-listen-for-event");d&&e.vm.$on(d,function(){s.call(e)})}},s=function(e){var t=this.scrollEventTarget,i=this.el,o=this.distance;if(e===!0||!this.disabled){var c=n(t),u=c+r(t),s=!1;if(t===i)s=t.scrollHeight-u<=o;else{var a=l(i)-l(t)+i.offsetHeight+c;s=u+o>=a}s&&this.expression&&this.expression()}},a={bind:function(t,n,i){t[e]={el:t,vm:i.context,expression:n.value};var o=arguments;t[e].vm.$on("hook:mounted",function(){t[e].vm.$nextTick(function(){c(t)&&u.call(t[e],o),t[e].bindTryCount=0;var n=function n(){t[e].bindTryCount>10||(t[e].bindTryCount++,c(t)?u.call(t[e],o):setTimeout(n,50))};n()})})},unbind:function(t){t&&t[e]&&t[e].scrollEventTarget&&t[e].scrollEventTarget.removeEventListener("scroll",t[e].scrollListener)}},d=function(e){e.directive("InfiniteScroll",a)};return window.Vue&&(window.infiniteScroll=a,Vue.use(d)),a.install=d,a});